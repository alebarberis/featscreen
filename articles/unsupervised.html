<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="featscreen">
<title>Unupervised screening methods • featscreen</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Unupervised screening methods">
<meta property="og:description" content="featscreen">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">featscreen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/featscreen.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Screening</h6>
    <a class="dropdown-item" href="../articles/supervised.html">Supervised screening methods</a>
    <a class="dropdown-item" href="../articles/unsupervised.html">Unupervised screening methods</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alebarberis/featscreen/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Unupervised screening methods</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alebarberis/featscreen/blob/HEAD/vignettes/unsupervised.Rmd" class="external-link"><code>vignettes/unsupervised.Rmd</code></a></small>
      <div class="d-none name"><code>unsupervised.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Unsupervised feature screening empowers users to uncover hidden
insights and identify influential features without relying on explicit
target labels.</p>
<p>Unsupervised methods operate on the inherent structure of the data,
allowing for an unbiased examination of feature characteristics. By
selectively retaining features that exhibit specific behaviors,
unsupervised screening aids in reducing the dimensionality of datasets,
facilitating more focused analyses.</p>
<p><strong>featscreen</strong> provides different methods catering to a
range of scenarios, from handling missing values to exploring
variability and ratios, providing flexibility in addressing diverse data
challenges.</p>
<p>In this article we explore the different unsupervised feature
screening methods supported by <strong>featscreen</strong>.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Firstly, we load <code>featscreen</code> and other needed
packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alebarberis/featscreen" class="external-link">featscreen</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'featscreen'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     mad, sd</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:graphics':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     screen</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="seed">Seed<a class="anchor" aria-label="anchor" href="#seed"></a>
</h2>
<p>Now we want to set a seed for the random number generation (RNG). In
fact, different R sessions have different seeds created from current
time and process ID by default, and consequently different simulation
results. By fixing a seed we ensure we will be able to reproduce the
results of this vignette. We can specify a seed by calling
<code><a href="https://rdrr.io/r/base/Random.html" class="external-link">?set.seed</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Set a seed for RNG</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span></span>
<span>  <span class="co">#A seed</span></span>
<span>  seed <span class="op">=</span> <span class="fl">5381L</span>,                   <span class="co">#a randomly chosen integer value</span></span>
<span>  <span class="co">#The kind of RNG to use</span></span>
<span>  kind <span class="op">=</span> <span class="st">"Mersenne-Twister"</span>,      <span class="co">#we make explicit the current R default value</span></span>
<span>  <span class="co">#The kind of Normal generation</span></span>
<span>  normal.kind <span class="op">=</span> <span class="st">"Inversion"</span>       <span class="co">#we make explicit the current R default value</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="screening-methods">Screening Methods<a class="anchor" aria-label="anchor" href="#screening-methods"></a>
</h2>
<p>To view the list of currently supported supervised screening methods,
use the <code><a href="../reference/listAvailableScreeningMethods.html">?listAvailableScreeningMethods</a></code> function with the
<code>x</code> parameter set to <code>unsupervised</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#list screening methods</span></span>
<span><span class="va">screening.methods</span> <span class="op">=</span> <span class="fu"><a href="../reference/listAvailableScreeningMethods.html">listAvailableScreeningMethods</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">'unsupervised'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#print in table</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">screening.methods</span>, align <span class="op">=</span> <span class="st">'rc'</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">id</th>
<th align="center">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">missing.value</td>
<td align="center">missing value ratio</td>
</tr>
<tr class="even">
<td align="right">above.median</td>
<td align="center">above-median frequency ratio</td>
</tr>
<tr class="odd">
<td align="right">above.minimum</td>
<td align="center">above-minimum frequency ratio</td>
</tr>
<tr class="even">
<td align="right">median</td>
<td align="center">median value</td>
</tr>
<tr class="odd">
<td align="right">variability</td>
<td align="center">variability</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="missing-value-ratio">Missing-Value Ratio<a class="anchor" aria-label="anchor" href="#missing-value-ratio"></a>
</h2>
<p>The missing-value-ratio method targets features based on the
proportion of missing values they contain. This statistic allows users
to set a threshold, filtering out features that surpass a specified
percentage of missing data. By doing so, analysts can identify features
that might lack sufficient information for meaningful analysis.</p>
<p>To employ the missing-value ratio method in
<strong>featscreen</strong>, the <code><a href="../reference/rowMissingValueRatio.html">?rowMissingValueRatio</a></code>
function is utilized.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Define row/col size</span></span>
<span><span class="va">nr</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">nc</span> <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co">#Data</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, size <span class="op">=</span> <span class="va">nr</span><span class="op">*</span><span class="va">nc</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">nr</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">nc</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Force 1st feature to have 40% of missing values</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nc</span><span class="op">*</span><span class="fl">0.4</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowMissingValueRatio.html">rowMissingValueRatio</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;  f1  f2  f3  f4  f5 </span></span>
<span><span class="co">#&gt; 0.4 0.0 0.0 0.0 0.0</span></span></code></pre></div>
<p>We might be interested to know the missing value ratio per each
group.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowMissingValueRatio.html">rowMissingValueRatio</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, g <span class="op">=</span> <span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt;      a b</span></span>
<span><span class="co">#&gt; f1 0.8 0</span></span>
<span><span class="co">#&gt; f2 0.0 0</span></span>
<span><span class="co">#&gt; f3 0.0 0</span></span>
<span><span class="co">#&gt; f4 0.0 0</span></span>
<span><span class="co">#&gt; f5 0.0 0</span></span></code></pre></div>
<p><code><a href="../reference/rowFilterByMissingValueRatio.html">?rowFilterByMissingValueRatio</a></code> is a ready-to-use filter
function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowFilterByMissingValueRatio.html">rowFilterByMissingValueRatio</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x</span>, </span>
<span>  g <span class="op">=</span> <span class="va">g</span>,</span>
<span>  <span class="co"># Maximum proportion of samples with missing values</span></span>
<span>  max.prop <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    f1    f2    f3    f4    f5 </span></span>
<span><span class="co">#&gt; FALSE  TRUE  TRUE  TRUE  TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="threshold-based-selection">Threshold-Based Selection<a class="anchor" aria-label="anchor" href="#threshold-based-selection"></a>
</h2>
<p>Common unsupervised screening strategies are based on the feature
values. These statistics allow users to set a threshold, filtering out
features with values below the defined cutoff.</p>
<p>Typically applied to gene expression data, this rule is motivated by
the notion that a gene must exhibit a minimal level of expression to be
biologically relevant. A commonly used cut-off is the median expression
of genes in a sample. Further refinement includes retaining features
only if they surpass the threshold in a specified number of samples.</p>
<div class="section level3">
<h3 id="above-median-frequency-ratio">Above-Median Frequency Ratio<a class="anchor" aria-label="anchor" href="#above-median-frequency-ratio"></a>
</h3>
<p>This unsupervised screening approach can be instrumental in isolating
features showcasing distinct behavior relative to the samples’ central
tendency.</p>
<p>This technique allows users to define a threshold based on the median
value, thereby retaining features with above-median characteristics.</p>
<p>The above-median frequency ratio is computed in
<strong>featscreen</strong> by calling the function
<code><a href="../reference/rowAboveMedianFreqRatio.html">?rowAboveMedianFreqRatio</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Define row/col size</span></span>
<span><span class="va">nr</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">nc</span> <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co">#Data</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, size <span class="op">=</span> <span class="va">nr</span><span class="op">*</span><span class="va">nc</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">nr</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">nc</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowAboveMedianFreqRatio.html">rowAboveMedianFreqRatio</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;  f1  f2  f3  f4  f5 </span></span>
<span><span class="co">#&gt; 0.6 0.7 0.7 0.5 0.5</span></span></code></pre></div>
<p>We might be interested to know the above-median frequency ratio per
each group.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowAboveMedianFreqRatio.html">rowAboveMedianFreqRatio</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, g <span class="op">=</span> <span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt;      a   b</span></span>
<span><span class="co">#&gt; f1 0.6 0.6</span></span>
<span><span class="co">#&gt; f2 0.6 0.8</span></span>
<span><span class="co">#&gt; f3 0.8 0.6</span></span>
<span><span class="co">#&gt; f4 0.6 0.4</span></span>
<span><span class="co">#&gt; f5 0.4 0.6</span></span></code></pre></div>
<p><code><a href="../reference/rowFilterByAboveMedianRatio.html">?rowFilterByAboveMedianRatio</a></code> is a ready-to-use filter
function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowFilterByAboveMedianRatio.html">rowFilterByAboveMedianRatio</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x</span>, </span>
<span>  g <span class="op">=</span> <span class="va">g</span>,</span>
<span>  <span class="co"># Minimum proportion of samples where the feature expression is above the median</span></span>
<span>  min.prop <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   f1   f2   f3   f4   f5 </span></span>
<span><span class="co">#&gt; TRUE TRUE TRUE TRUE TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="above-minimum-frequency-ratio">Above-Minimum Frequency Ratio<a class="anchor" aria-label="anchor" href="#above-minimum-frequency-ratio"></a>
</h3>
<p>The <strong>above-minimum ratio</strong> method focuses on features
with values surpassing a defined minimum threshold. Users can set a
minimum value, retaining features that exhibit behaviors above this
specified limit.</p>
<p>The above-minimum frequency ratio is computed in
<strong>featscreen</strong> by calling the function
<code><a href="../reference/rowAboveMinFreqRatio.html">?rowAboveMinFreqRatio</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Define row/col size</span></span>
<span><span class="va">nr</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">nc</span> <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co">#Data</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, size <span class="op">=</span> <span class="va">nr</span><span class="op">*</span><span class="va">nc</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">nr</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">nc</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowAboveMinFreqRatio.html">rowAboveMinFreqRatio</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, min.expr <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt;  f1  f2  f3  f4  f5 </span></span>
<span><span class="co">#&gt; 0.9 0.7 1.0 0.8 0.8</span></span></code></pre></div>
<p>We might be interested to know the above-minimum frequency ratio per
each group.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowAboveMinFreqRatio.html">rowAboveMinFreqRatio</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, min.expr <span class="op">=</span> <span class="fl">20</span>, g <span class="op">=</span> <span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt;      a   b</span></span>
<span><span class="co">#&gt; f1 1.0 0.8</span></span>
<span><span class="co">#&gt; f2 0.8 0.6</span></span>
<span><span class="co">#&gt; f3 1.0 1.0</span></span>
<span><span class="co">#&gt; f4 1.0 0.6</span></span>
<span><span class="co">#&gt; f5 0.6 1.0</span></span></code></pre></div>
<p><code><a href="../reference/rowFilterByAboveMinRatio.html">?rowFilterByAboveMinRatio</a></code> is a ready-to-use filter
function.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowFilterByAboveMinRatio.html">rowFilterByAboveMinRatio</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x</span>, </span>
<span>  g <span class="op">=</span> <span class="va">g</span>,</span>
<span>  <span class="co"># Minimum expression required</span></span>
<span>  min.expr <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  <span class="co"># Minimum proportion of samples where the feature expression is above the min</span></span>
<span>  min.prop <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    f1    f2    f3    f4    f5 </span></span>
<span><span class="co">#&gt;  TRUE FALSE  TRUE FALSE  TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="median-values">Median Values<a class="anchor" aria-label="anchor" href="#median-values"></a>
</h3>
<p>Commonly used in gene expression data, the median value is used as an
indication of the level of expression. This is motivated by the notion
that a gene must exhibit a minimal level of expression to be
biologically relevant.</p>
<p>The median values are computed in <strong>featscreen</strong> by
calling the function <code><a href="../reference/rowMedians.html">?rowMedians</a></code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Define row/col size</span></span>
<span><span class="va">nr</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">nc</span> <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co">#Data</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, size <span class="op">=</span> <span class="va">nr</span><span class="op">*</span><span class="va">nc</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">nr</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">nc</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowMedians.html">rowMedians</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;   f1   f2   f3   f4   f5 </span></span>
<span><span class="co">#&gt; 53.0 84.5 52.0 55.0 75.0</span></span></code></pre></div>
<p>We might be interested to know the median value per each group.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowMedians.html">rowMedians</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, g <span class="op">=</span> <span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt;     a  b</span></span>
<span><span class="co">#&gt; f1 55 51</span></span>
<span><span class="co">#&gt; f2 59 86</span></span>
<span><span class="co">#&gt; f3 42 53</span></span>
<span><span class="co">#&gt; f4 19 57</span></span>
<span><span class="co">#&gt; f5 84 59</span></span></code></pre></div>
<p><code><a href="../reference/rowFilterByMedianAboveMinExpr.html">?rowFilterByMedianAboveMinExpr</a></code> is a ready-to-use filter
function.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowFilterByMedianAboveMinExpr.html">rowFilterByMedianAboveMinExpr</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x</span>, </span>
<span>  g <span class="op">=</span> <span class="va">g</span>,</span>
<span>  <span class="co"># Median minimum expression required</span></span>
<span>  min.expr <span class="op">=</span> <span class="fl">60</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    f1    f2    f3    f4    f5 </span></span>
<span><span class="co">#&gt; FALSE  TRUE FALSE FALSE  TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="variability-based-selection">Variability-Based Selection<a class="anchor" aria-label="anchor" href="#variability-based-selection"></a>
</h2>
<p>Another commonly used unsupervised screening strategy is based on the
feature variability, i.e., features showing higher variability across
samples are prioritized. The rationale is that genes with substantial
variability may capture interesting variations linked to experimental
conditions (e.g., drug administration). Variability can be measured
using standard deviation, interquartile range, or median absolute
deviation.</p>
<p>The above-minimum frequency ratio is computed in
<strong>featscreen</strong> by calling the function
<code><a href="../reference/rowVariability.html">?rowVariability</a></code>.</p>
<p>Five measures of variability are available:</p>
<ul>
<li>
<code>sd</code>: The standard deviation.</li>
<li>
<code>iqr</code>: The interquartile range.</li>
<li>
<code>mad</code>: The median absolute deviation.</li>
<li>
<code>rsd</code>: The relative standard deviation (i.e., coefficient
of variation).</li>
<li>
<code>efficiency</code>: The coefficient of variation squared.</li>
<li>
<code>vmr</code>: The variance-to-mean ratio.</li>
</ul>
<p>We can provide the type of measure we want to use as the
<code>method</code> argument in <code><a href="../reference/rowVariability.html">?rowVariability</a></code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Define row/col size</span></span>
<span><span class="va">nr</span> <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="va">nc</span> <span class="op">=</span> <span class="fl">10</span></span>
<span></span>
<span><span class="co">#Data</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, size <span class="op">=</span> <span class="va">nr</span><span class="op">*</span><span class="va">nc</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  nrow <span class="op">=</span> <span class="va">nr</span>,</span>
<span>  ncol <span class="op">=</span> <span class="va">nc</span>,</span>
<span>  dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"f"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nr</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"S"</span>,<span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowVariability.html">rowVariability</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">'sd'</span><span class="op">)</span></span>
<span><span class="co">#&gt;       f1       f2       f3       f4       f5 </span></span>
<span><span class="co">#&gt; 36.74250 24.09265 34.13844 30.32857 28.79062</span></span></code></pre></div>
<p>We might be interested to know the variability per each group.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowVariability.html">rowVariability</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, method <span class="op">=</span> <span class="st">'sd'</span>, g <span class="op">=</span> <span class="va">g</span><span class="op">)</span></span>
<span><span class="co">#&gt;           a        b</span></span>
<span><span class="co">#&gt; f1 34.91132 39.41446</span></span>
<span><span class="co">#&gt; f2 24.97399 22.39866</span></span>
<span><span class="co">#&gt; f3 28.90848 41.49096</span></span>
<span><span class="co">#&gt; f4 30.08654 33.94554</span></span>
<span><span class="co">#&gt; f5 13.22876 40.88765</span></span></code></pre></div>
<p><code><a href="../reference/rowFilterByLowVariability.html">?rowFilterByLowVariability</a></code> is a ready-to-use filter
function.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Grouping variable</span></span>
<span><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="va">nc</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Compute</span></span>
<span><span class="fu"><a href="../reference/rowFilterByLowVariability.html">rowFilterByLowVariability</a></span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="va">x</span>, </span>
<span>  g <span class="op">=</span> <span class="va">g</span>, </span>
<span>  method <span class="op">=</span> <span class="st">'sd'</span>,</span>
<span>  <span class="co"># Percentage of features with highest variability to keep</span></span>
<span>  percentile <span class="op">=</span> <span class="fl">0.25</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    f1    f2    f3    f4    f5 </span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE FALSE FALSE</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alessandro Barberis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
